local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local PathfindingService = game:GetService("PathfindingService")
local Players = game:GetService("Players")

local Player = Players.LocalPlayer
local Character = Player.Character
local HumanoidRootPart = Character.HumanoidRootPart

local AutoSave = false

function TweenCFrame(Object, Speed, Goal)
    local path = PathfindingService:CreatePath({
        AgentRadius = 2,
        AgentHeight = 5,
        AgentCanJump = true,
        AgentJumpHeight = 10,
        AgentMaxSlope = 45,
    })

    path:ComputeAsync(Object.Position, targetPosition)

    path.StatusChanged:Connect(function(status)
        if status == Enum.PathStatus.Success then
            local Distance = (Object.Position - Goal.Position).Magnitude
            local Tween = TweenService:Create(Object, TweenInfo.new(Distance / Speed), {CFrame = Goal.CFrame + CFrame.new(0, 10, 0)})
            Tween:Play()
        end
    end)
    
    path:MoveTo(Object.Parent)

    repeat
        wait()
    until Object.CFrame = Goal.CFrame + CFrame.new(0, 10, 0)
end

function TweenColor(Object, Time, Color, Ui)
    if Ui then
        local Tween = TweenService:Create(Object, TweenInfo.new(Time), {BackgroundColor3 = Color})
        Tween:Play()
    else
        local Tween = TweenService:Create(Object, TweenInfo.new(Time), {BrickColor.Color = Color})
        Tween:Play()
    end
end

function PressE()
    local Args = {
        [1] = "Input"
        [2] = "Action"
        [3] = true
    }

    ReplicatedStorage.RemoteEvent:FireServer(unpack(Args))
end

function UnpressE()
    local Args = {
        [1] = "Input"
        [2] = "Action"
        [3] = false
    }

    ReplicatedStorage.RemoteEvent:FireServer(unpack(Args))
end

local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("  ðŸ–¥ Flee the facility ðŸ–¥   ", "BloodTheme")

local MainTab = Window:NewTab("Auto")
local CreditsTab = Window:NewTab("Credits")

local SurvivorSection = MainTab:NewSection("Survivor")
local CreditsSection = CreditsTab:NewSection("Credits to Infinite_BlowUP for making this script")

AutoSection:NewToggle("Auto Save", "Auto save players for XP", function(state)
    if state then
        print("Auto Save On")
        AutoSave = true
    else
        print("Auto Save Off")
        AutoSave = false
    end
end)

while wait() do
    if AutoSave then
        for _, v in ipairs(Players:GetPlayers()) do
            local VCharacter = v.Character
            local VHumanoidRootPart = VCharacter.HumanoidRootPart
            local TempPlayerStatsModule = v:FindFirstChild("TempPlayerStatsModule")

            if TempPlayerStatsModule then
                local Captured = TempPlayerStatsModule.Captured.Value

                if Captured then
                    TweenCFrame(HumanoidRootPart, 50, VHumanoidRootPart)
                    PressE()
                    
                    wait(math.random(0, 50) / 100)

                    UnpressE()
                end
            end
        end
    end
end
